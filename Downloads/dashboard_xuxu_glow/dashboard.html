
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard Xuxu Glow</title>
    <link rel="stylesheet" href="style_dashboard.css" />
</head>
<body>
    <div class="dashboard-container">
        <h1>📊 Dashboard Xuxu Glow</h1>
        <div class="tabs">
            <button class="tab-button active" onclick="openTab('vendas')">Vendas</button>
            <button class="tab-button" onclick="openTab('faturamento')">Maior Faturamento</button>
        </div>

        <div id="vendas" class="tab-content active">
            <h2>📈 Dados de Vendas</h2>
            <div class="table-wrapper" id="vendasTable">Carregando vendas...</div>
        </div>

        <div id="faturamento" class="tab-content">
            <h2>💰 Maior Faturamento</h2>
            <div class="table-wrapper" id="faturamentoTable">Carregando faturamento...</div>
        </div>

        <a href="index.html" class="back-button">← Voltar à Página Inicial</a> <!-- OBS: link para página inicial -->
    </div>

    <script>
        function openTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById(tabId).classList.add('active');
            event.currentTarget.classList.add('active');
        }

        function carregarCSV(url, containerId) {
            fetch(url)
                .then(resp => resp.ok ? resp.text() : Promise.reject(`Erro ${resp.status}`))
                .then(csv => {
                    const rows = csv.trim().split(/\r?\n/);
                    const headers = parseCSVRow(rows[0]);
                    const table = document.createElement('table');
                    const thead = table.createTHead();
                    const headerRow = thead.insertRow();
                    headers.forEach(h => {
                        const th = document.createElement('th');
                        th.textContent = h;
                        headerRow.appendChild(th);
                    });

                    const tbody = table.createTBody();
                    rows.slice(1).forEach(row => {
                        const tr = tbody.insertRow();
                        parseCSVRow(row).forEach(cell => {
                            const td = tr.insertCell();
                            td.textContent = cell.trim();
                        });
                    });

                    document.getElementById(containerId).innerHTML = '';
                    document.getElementById(containerId).appendChild(table);
                })
                .catch(err => {
                    document.getElementById(containerId).innerHTML = `<p class="error-message">Erro ao carregar dados: ${err}</p>`;
                });
        }

        function parseCSVRow(row) {
            const result = [];
            let current = '', inQuotes = false;
            for (let i = 0; i < row.length; i++) {
                const c = row[i];
                if (c === '"') {
                    if (inQuotes && row[i + 1] === '"') {
                        current += '"';
                        i++;
                    } else {
                        inQuotes = !inQuotes;
                    }
                } else if (c === ',' && !inQuotes) {
                    result.push(current);
                    current = '';
                } else {
                    current += c;
                }
            }
            result.push(current);
            return result;
        }

        // Carrega ambas as planilhas ao abrir a página
        window.onload = function() {
            carregarCSV("https://docs.google.com/spreadsheets/d/e/2PACX-1vRIfu_bkc8cu1dNbItO9zktGmn4JjNjQEoLAzGcG9rZDyfDyDp4ISEqpPKzIFTWFrMNVIz05V3NTpGT/pub?gid=0&single=true&output=csv", "vendasTable");
            carregarCSV("https://docs.google.com/spreadsheets/d/e/2PACX-1vRIfu_bkc8cu1dNbItO9zktGmn4JjNjQEoLAzGcG9rZDyfDyDp4ISEqpPKzIFTWFrMNVIz05V3NTpGT/pub?gid=2052374642&single=true&output=csv", "faturamentoTable");
        }
    </script>
</body>
</html>
